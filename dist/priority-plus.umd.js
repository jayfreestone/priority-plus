!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).priorityPlus=n()}(this,function(){"use strict";var e,n,r,t,a=function(){return(a=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var a in n=arguments[r])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}).apply(this,arguments)};function i(e,n){return void 0===n&&(n={}),new CustomEvent(e,{detail:n})}function o(e,n,r){return function(e){return[!(e instanceof Element)&&"Target must be an HTMLElement.",(!e.children||!e.children.length)&&"Target must be the direct parent of the individual nav items."].filter(Boolean)}(e).concat(function(e,n){return Object.keys(e).map(function(e){return void 0===n[e]?"Unrecognised option: "+e:void 0}).filter(Boolean)}(n,r))}function l(e,n,r){!function(e){if(e&&e.length)throw new Error("\n- "+e.join("\n- "))}(o(e,n,r))}!function(e){e.ShowOverflow="showOverflow",e.HideOverflow="hideOverflow",e.ItemsChanged="itemsChanged"}(e||(e={})),function(e){e.Container="container",e.Main="main",e.PrimaryNavWrapper="primary-nav-wrapper",e.PrimaryNav="primary-nav",e.OverflowNav="overflow-nav",e.ToggleBtn="toggle-btn",e.NavItems="nav-item"}(r||(r={})),function(e){e.ButtonVisible="is-showing-toggle",e.OverflowVisible="is-showing-overflow",e.PrimaryHidden="is-hiding-primary"}(t||(t={}));var v={classNames:(n={},n[r.Container]=["p-plus-container"],n[r.Main]=["p-plus"],n[r.PrimaryNavWrapper]=["p-plus__primary-wrapper"],n[r.PrimaryNav]=["p-plus__primary"],n[r.OverflowNav]=["p-plus__overflow"],n[r.ToggleBtn]=["p-plus__toggle-btn"],n),defaultOverflowVisible:!1,innerToggleTemplate:"More"};return function(n,o){var s,c,d;void 0===o&&(o={});var u,f,p={addEventListener:(u=(new MessageChannel).port1).addEventListener.bind(u),dispatchEvent:u.dispatchEvent.bind(u),removeEventListener:u.removeEventListener.bind(u)},m={eventListeners:new Map,eventReady:!1,itemMap:new WeakMap,observer:void 0},g=a({},v,o,{classNames:a({},v.classNames,o.classNames)}),y=g.classNames,N=((s={})[r.Container]=void 0,s.clone=((c={})[r.Main]=void 0,c[r.NavItems]=void 0,c[r.ToggleBtn]=void 0,c),s.primary=((d={})[r.Main]=void 0,d[r.PrimaryNav]=void 0,d[r.NavItems]=void 0,d[r.OverflowNav]=void 0,d[r.ToggleBtn]=void 0,d),s),h=(f=new WeakMap,function(e,n){return f.get(e)||f.set(e,new Map(Array.from(e).reduce(function(e,r,t){return e.concat([[r,n[t]]])},[]))),f.get(e)});function w(e){return y[e].join(" ")}function M(e){return"data-"+e}function b(e,n){return void 0===n&&(n={}),"string"==typeof e?e:e(n)}function O(){var e,a=m.itemMap,i="\n      <div "+M(r.Main)+' class="'+w(r.Main)+'">\n        <div class="'+w(r.PrimaryNavWrapper)+'">\n          <'+n.tagName+"\n            "+M(r.PrimaryNav)+'\n            class="'+w(r.PrimaryNav)+'"\n          >\n            '+Array.from(n.children).map(function(e){return"<li "+M(r.NavItems)+">"+e.innerHTML+"</li>"}).join("")+"\n          </"+n.tagName+">\n        </div>\n        <button\n          "+M(r.ToggleBtn)+'\n          class="'+w(r.ToggleBtn)+'"\n          aria-expanded="false"\n        >'+b(g.innerToggleTemplate)+"</button>\n        <"+n.tagName+"\n          "+M(r.OverflowNav)+'\n          class="'+w(r.OverflowNav)+'"\n          aria-hidden="true"\n        >\n        </'+n.tagName+">\n      </div>\n    ",o=document.createElement("div");(e=o.classList).add.apply(e,y[r.Container]),o.setAttribute(M(r.Container),"true"),N[r.Container]=o;var l=document.createRange().createContextualFragment(i),v=l.cloneNode(!0);N.primary[r.Main]=l.querySelector("["+M(r.Main)+"]"),N.primary[r.PrimaryNav]=l.querySelector("["+M(r.PrimaryNav)+"]"),N.primary[r.NavItems]=Array.from(l.querySelectorAll("["+M(r.NavItems)+"]")),N.primary[r.OverflowNav]=l.querySelector("["+M(r.OverflowNav)+"]"),N.primary[r.ToggleBtn]=l.querySelector("["+M(r.ToggleBtn)+"]"),N.clone[r.Main]=v.querySelector("["+M(r.Main)+"]"),N.clone[r.NavItems]=Array.from(v.querySelectorAll("["+M(r.NavItems)+"]")),N.clone[r.ToggleBtn]=v.querySelector("["+M(r.ToggleBtn)+"]"),N.clone[r.Main].setAttribute("aria-hidden","true"),N.clone[r.Main].setAttribute("data-clone","true"),N.clone[r.Main].classList.add(y[r.Main][0]+"--clone"),N.clone[r.Main].classList.add(y[r.Main][0]+"--"+t.ButtonVisible),o.appendChild(l),o.appendChild(v),N.clone[r.NavItems].forEach(function(e){return a.set(e,r.PrimaryNav)}),n.parentNode.replaceChild(o,n)}function T(e){var n=function(e){var n=m.itemMap,t=N.primary[e].cloneNode();return N.clone[r.NavItems].filter(function(r){return n.get(r)===e}).forEach(function(e){t.appendChild(h(N.clone[r.NavItems],N.primary[r.NavItems]).get(e))}),t}(e);N.primary[e].parentNode.replaceChild(n,N.primary[e]),N.primary[e]=n}function C(e){var n=e.target,t=e.intersectionRatio;m.itemMap.set(n,t<.99?r.OverflowNav:r.PrimaryNav)}function E(n){n.forEach(C),[r.PrimaryNav,r.OverflowNav].forEach(T),p.dispatchEvent(function(n){var r=n.overflowCount;return i(e.ItemsChanged,{overflowCount:r})}({overflowCount:N.primary[r.OverflowNav].children.length})),m.eventReady=!0}function L(n){void 0===n&&(n=!0);var a=y[r.Main][0]+"--"+t.OverflowVisible;return N.primary[r.Main].classList[n?"add":"remove"](a),N.primary[r.OverflowNav].setAttribute("aria-hidden",n?"false":"true"),N.primary[r.ToggleBtn].setAttribute("aria-expanded",n?"true":"false"),p.dispatchEvent(i(n?e.ShowOverflow:e.HideOverflow)),this}function B(){var e=y[r.Main][0]+"--"+t.OverflowVisible;return L(!N.primary[r.Main].classList.contains(e)),this}function I(e){e.preventDefault(),B()}function P(e){var n,a=e.detail.overflowCount;void 0===(n=a>0)&&(n=!0),N.primary[r.Main].classList[n?"add":"remove"](y[r.Main][0]+"--"+t.ButtonVisible),"string"!=typeof g.innerToggleTemplate&&[N.primary[r.ToggleBtn],N.clone[r.ToggleBtn]].forEach(function(e){e.innerHTML=b(g.innerToggleTemplate,{toggleCount:N.primary[r.OverflowNav].children.length,totalCount:N.clone[r.NavItems].length})}),0===a&&L(!1),function(e){void 0===e&&(e=!0);var n=y[r.Main][0]+"--"+t.PrimaryHidden;N.primary[r.Main].classList[e?"add":"remove"](n),N.primary[r.PrimaryNav].setAttribute("aria-hidden",String(e))}(a===N.clone[r.NavItems].length)}function A(e,n,r){function t(e){r&&!m.eventReady||n(e)}return void 0===r&&(r=!0),m.eventListeners.set(n,{eventType:e,wrappedCallback:t}),p.addEventListener(e,t),this}function S(e,n){var r=m.eventListeners.get(n).wrappedCallback;return p.removeEventListener(e,r),this}return l(n,o,v),O(),m.observer=new IntersectionObserver(E,{root:N.clone[r.Main],rootMargin:"0px 0px 0px 0px",threshold:[.99]}),N.clone[r.NavItems].forEach(function(e){return m.observer.observe(e)}),N.primary[r.ToggleBtn].addEventListener("click",I),A(e.ItemsChanged,P,!1),g.defaultOverflowVisible&&L(!0),{destroy:function(){m.observer.disconnect(),N.primary[r.ToggleBtn].removeEventListener("click",I),Array.from(m.eventListeners.entries()).forEach(function(e){var n=e[0];S(e[1].eventType,n)}),N[r.Container].parentNode.replaceChild(n,N[r.Container])},getNavElements:function(){return a({},N.primary)},off:S,on:A,setOverflowNavOpen:L,toggleOverflowNav:B}}});
